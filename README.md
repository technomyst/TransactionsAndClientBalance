# TransactionsAndClientBalances
Что можно улучшить:
- Добавить паттерн Result, заменить часть ответов Exception на Result, где это возможно.
- Сократить дублирование кода в TransactionRepository. Этому мешает два условия:
    1. Сократить количество операций с таблицами в транзакции БД.  
    2. Дата перечета баланса должна быть больше даты вставки транзакции.  

Поскольку при обработке кредит и дебит-транзакций есть отличия, то вместо одного метода с if было принято решение вынести в разные методы для каждого типа.
Очень хотелось применить паттерн "Стратегия" для расчета баланса (метод ApplyTransaction закомментирован в классе ClientBalance), но указанные выше пункты 1 и 2 пока не дают это сделать.  

...
    
      
#Исходное задание

Дан interface, описывающий финансовую транзакцию:  
public interface ITransaction  
{  
Guid Id { get; }   
Guid ClientId { get; }  
DateTime DateTime { get; }  
decimal Amount { get; }  
}  
Создайте реализации этого интерфейса CreditTransaction (зачисление средств клиенту), DebitTransaction
(списание средств у клиента). Напишите Web API, позволяющее зачислять и списывать средства у
указанного клиента, отменять указанную транзакцию и получать актуальный баланс клиента. В сервисе
должно быть 4 запроса:  
POST /credit  
{  
"id":"8f0452b2-867b-4ef8-9a9d-3c9c03d9afdf",  
"clientId": "cfaa0d3f-7fea-4423-9f69-ebff826e2f89",  
"dateTime":"2019-04-02T13:10:20.0263632+03:00",  
"amount":23.05  
}  
Response 200 OK:  
{  
"insertDateTime": "2024-10-25T12:03:34+05:00",  
"clientBalance": 23.05  
}  
POST /debit  
{  
"id":"05eb235c-4955-4c16-bcdd-34e8178228de",  
"clientId": "cfaa0d3f-7fea-4423-9f69-ebff826e2f89",  
"dateTime":"2019-04-02T13:10:25.0263632+03:00",  
"amount":23.05  
}  
Response 200 OK:  
{  
"insertDateTime": "2024-10-25T12:03:34+05:00",  
"clientBalance": 0  
}  
POST /revert?id=05eb235c-4955-4c16-bcdd-34e8178228de  
Response 200 OK:  
{  
"revertDateTime": "2024-10-25T12:03:34+05:00",  
"clientBalance": 23.05  
}  
GET /balance?id=05eb235c-4955-4c16-bcdd-34e8178228de  
Response 200 OK:  
{  
"balanceDateTime": "2024-10-25T12:03:34+05:00",  
"clientBalance": 23.05  
}  

Методы POST должны быть идемпотентными: при повторной отправке запроса он должен
возвращать результат отправки предыдущего запроса с таким же Id.  
Необходимо реализовать валидацию: сумма в транзакциях должна быть всегда положительной,
дата не может быть в будущем, у клиента нельзя списать больше средств, чем есть на балансе.
Обработку ошибок необходимо реализовать в соответствии с RFC 9457.  
Способ хранения данных - на усмотрение соискателя.  
Способ логирования - на усмотрения соискателя.  
Дополнительная функциональность - на усмотрение соискателя.  
Приветствуется проектирование решения с залогом на поддержку и развитие сервиса.  
